## 정규화를 하는 이유

한 릴레이션(Relation)에 여러 엔티티의 속성을 혼합하면 정보가 중복 저장되며 저장 공간을 낭비하게 된다.
또 중복된 정보로 인해 '이상 현상'이 발생하게 된다. 이러한 문제를 해결하기 위해 정규화 과정을 거치는 것이다.

## 정규화

Attribute 간의 종속성으로 인한 이상현상이 발생하는 릴레이션을 분해하여 재디자인함으로써 이상현상을 없애는 과정
데이터의 중복 방지, 무결성을 충족하기 위해 데이터베이스를 분리하여 설계하는 방법

### 데이터베이스 이상(Anomaly)

정규화(Normalization)를 거치지 않으면 데이터베이스 내에 데이터들이 불필요하게 중복되어 릴레이션 조작 시 예기치 못한 곤란한 현상이 발생하는데, 이를 이상(Anomaly)이라 하며 다음과 같이 삽입 이상, 삭제 이상, 갱신 이상이 있다.

- 삽입 이상(Insertion Anomaly) : 릴레이션에 데이터를 삽입할 때 불필요한 컬럼인데도 필드의 값이 NULLABLE 하지 않아 반드시 같이 삽입하지 않으면 실패하는 현상, 또는 자동으로 불필요한 데이터가 삽입되는 현상

- 삭제 이상(Deletion Anomaly) : 릴레이션에서 한 레코드(튜플)에서 일부 속성에 대한 데이터를 삭제해야 하는데 의도와는 상관없는 속성의 데이터들도 함께 삭제되는 연쇄 삭제 현상

- 갱신(수정) 이상(Update Anomaly) : 릴레이션에서 여러 개의 레코드(튜플)이 중복으로 가지고 있는 속성에 대한 데이터들을 갱신할 때 전부 변경하지 않고 일부 튜플에서만 변경하여 정보에 모순이 생기는 현상

### 정규형 원칙

1. 정보의 무손실 : 분해된 릴레이션이 표현하는 정보는 분해되기 전의 정보를 모두 포함해야 한다.
2. 최소 데이터 중복 : 이상 현상을 제거, 데이터 중복을 최소화
3. 분리의 원칙 : 하나의 독립된 관계성은 하나의 독립된 릴레이션으로 분리해서 표현

### 제 1 정규형

- 릴레이션(테이블)의 모든 도메인(값)이 더이상 분해될 수 없는 원자값만으로 구성되어야 한다.
- 릴레이션의 속성 값 중 한 개의 기본키에 대해 두 개 이상의 값을 가지는 반복집합이 있어서는 안된다. 만약 있다면 제거해야 한다
  - 기본키의 유일성을 버리고 복합키를 기본키로 쓰도록 하는 대안

### 제 2 정규형

- 제 2 정규형의 릴레이션들은 각각 제 1 정규형이면서, 기본키(primary key)에 속하지 않은 속성 모두가 기본키에 함수 종속이어야 한다. (완전 함수 종속)

\*함수 종속 : 예를 들어, 테이블에 <U>**생년월일**</U>과 <U>**나이**</U>라는 필드가 존재할 경우에 <U>**나이**</U> 필드는 <U>**생년월일**</U> 필드에 함수 종속이다. 즉 생년월일을 알고 있다면, 나이에 대한 필드를 참조하지 않아도 나이를 결정할 수 있다

### 제3정규형

- 제 2 정규형이면서, 기본키가 아닌 모든 속성이 이행적 함수종속을 만족하지 않는 상태.

\*이행적 함수 종속 : A -> B && B -> C일 때 A -> C 이므로, C는 A에 이행적 함수 종속이다.

### 보이스/코드 정규형 (BCNF)

- 제 3 정규형이면서, <U>결정자가 후보키가 아닌 함수 종속관계</U>를 <U>제거</U>하여 릴레이션의 함수 종속 관계에서 **모든 결정자가 후보키**인 상태. (모든 결정자가 후보키(유일, 최소)인 상태를 만족해야 한다.)

- 예시) 학번 / 과목명 / 강사 속성을 갖는 릴레이션(강사는 한 과목만 맡는다):
- 결정자:
  - 학번+과목명
  - 학번+강사
  - 강사

이 세개의 결정자 중에서 강사는 과목명에 대한 결정자이지만 후보키는 될 수 없다.
그래서 이러한 이상이 발생할 수 있다.

1. 삽입 이상 : 새로운 강사가 과목을 맡게된다는 정보를 삽입 불가
2. 삭제 이상 : 특정 학번이 과목을 수강한다는 정보를 삭제하면 해당 강사가 과목을 맡는다는 정보도 같이 사라짐
3. 갱신 이상 : 강사의 과목 정보가 변경되면 해당 강사의 과목 수강 정보가 담긴 모든 레코드를 찾아 바꾸어주어야 함

\*결정자 : 함수 종속 관계에서 독립인자를 결정자라고 한다. 반대는 종속자라고 한다.

이 릴레이션을 모든 결정자가 후보키인 두 개의 릴레이션으로 나누어 보이스/코드 정규화를 할 수 있다.

### 주의사항

정규화를 통해 릴레이션 분리가 많아지면 조인 쿼리가 많아져서 속도가 느려질 수도 있다. (비정규화 고려)

---

### 참고 링크

- https://rebro.kr/159 [Rebro의 코딩 일기장:티스토리]

- https://jess2.tistory.com/50
