## 메모리 계층

- CPU 내부
  - 레지스터
  - 캐시 (마더보드 안에 둘 수도 있음)
- RAM / 주기억장치
- HDD, SSD(SDD) / 보조기억장치

RAM은 보조기억장치로부터 데이터를 복사해서 임시 저장하고, 필요시 CPU에 전달. 시간이 걸린다.

높은 계층의 저장 장치일수록 가격이 비싸고 용량은 더 작다.

### 캐시 (L1/L2/L3)

캐시메모리는 CPU 안에 포함되는 작고 빠른 메모리로, CPU의 빠른 처리속도와 RAM의 느린 처리속도의 차이로 인한 병목을 줄이기 위해 데이터를 미리 복사해놓는 공간이다. CPU가 RAM에 요청하는 데이터는 캐시메모리에 복사된다.

### 캐시와 레지스터의 차이

현재 사용중인 데이터는 레지스터에, 최근 사용한 데이터는 캐시에 보관된다.

### 시간지역성, 공간지역성

한번 참조한 데이터를 여러번 참조하는 로직에서 이 데이터는 시간지역성을 갖는다.

순차적으로 참조하는 데이터들이 인접한 메모리에 위치한경우(ex. 배열 안의 연속된 값들) 이 데이터들은 공간지역성을 갖는 데이터들이다.

### 캐시 히트, 캐시 미스

- 캐시 히트 : 캐시에서 원하는 데이터를 찾아옴(CPU내부 버스 작동)
- 캐시 미스 : 캐시에서 원하는 데이터를 찾지 못하여 메모리에서 데이터를 찾아옴(시스템 버스 작동)

\* 버스(데이터 버스) : 컴퓨터 내부 또는 컴퓨터와 컴퓨터 간 데이터 커뮤니케이션 시스템.

### 캐시매핑

RAM의 데이터를 캐시메모리로 가져오는 기술.

#### 캐시매핑의 목적

캐시는 CPU가 자주 사용하는 데이터나 프로그램 정보를 '임시적으로' 저장한다. CPU는 필요한 데이터나 프로그램이 있으면 가장 먼저 캐시메모리부터 조회한다.

메모리 주소 '매핑'이 필요한 이유는 CPU와 RAM의 주소체계가 다르기 때문이다.

CPU는 가상 메모리 주소를 쓰기 때문에
RAM의 메모리 주소와 체계가 다르다. 그래서 중간에 메모리 관리 장치를 두고 주소변환을 하는데 캐시-RAM이 매핑된 방법에 따라 캐시에 위치한 주소를 다르게 해석한다.

- 직접 매핑 : RAM의 데이터를 캐시에 매핑할 때 공간지역성을 고려해 블록 단위로 매핑하면서 블록 정보는 태그로 함께 저장된다. 자주 사용되는 데이터와 자주 사용되지 않는 데이터 모두 같은 크기의 블록으로 나누어서 할당되기 때문에 캐시가 다 차서 교체되는(덮어쓰는) 일이 자주 발생할 수 있다(캐시충돌).

- 연관 매핑 : 순서를 일치 시키지 않고 관련 있는 캐시와 메모리를 매핑한다.
  필요한 캐시들 위주로 저장할 수 있어서 캐시히트 적중률이 높고 캐시충돌이 적다.캐시의 어디든 자유롭게 저장될 수 있으므로 탐색 속도는 상대적으로 느리다.

\* 캐시충돌이란 : 메모리가 같은 캐시를 반복적으로 덮어쓰는 것

- 집합 연관 매핑 : 순서는 일치시키지만 집합을 두어서 집합 내에서 무작위로 저장한다. 블록화가 되어있기 때문에 탐색이 효율적이면서, 저장 위치에 제약이 있는 것이 아니어서 적중률도 높은 편.

### 쿠키, 로컬 스토리지, 세션 스토리지

* 쿠키 
  * 만료기한이 있는 키-값 저장소
  * 만료기한은 일반적으로 서버에서 정한다

* 로컬 스토리지  
  * HTML5지원 브라우저에서만 사용가능
  * 만료기한이 없는 키-값 저장소 
  * 10MB까지 저장할 수 있다
  * 클라이언트에서만 수정 가능
  * 웹브라우저를 닫아도 유지된다
  * 도메인 단위로 저장, 생성된다

* 세션 스토리지 
  * HTML5지원 브라우저에서만 사용가능
  * 만료기한이 없는 키-값 저장소 
  * 5MB까지 저장할 수 있다
  * 클라이언트에서만 수정 가능
  * 탭 단위로 생성되며, 탭을 닫을 때 삭제된다 


### 데이터베이스의 캐싱 
메인 DB위에 레디스 DBMS 서버를 두어서 캐싱 계층으로 이용하기도 한다

redis는 키-값 구조의 비정형 데이터를 저장한다.

---

### 참고링크

https://byjus.com/gate/difference-between-cache-memory-and-register/

https://www.timesmojo.com/why-is-cache-mapping-needed/
